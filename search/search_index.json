{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Secure the Nutanix Cloud Platform (NCP)","text":""},{"location":"#the-story","title":"The Story","text":"<p>Your customer is a global manufacturer that needs to keep operations not just running but running securely, even during disasters. Their industry requires compliance audits for every step of the manufacturing process and all the systems that participate. They must keep sites running around the clock and can't tolerate downtime from ransomware or data breaches. Intellectual property is also a closely guarded secret. </p> <p>The CISO storms in and tells you and the customer's IT director that they're worried about ransomware and data breaches. They tell you to prepare a full demo showing all the capabilities of Nutanix to secure the environment. You've been given a 90-minute session. Of particular concern to the CISO is an email they got from the security operations team talking about CVE-2021-4034 (common vulnerabilities and exposures). They need you to explain what this means, how Nutanix can mitigate it, and satisfy their other security requirements.</p>"},{"location":"#objectives","title":"Objectives","text":"<p>This lab will give you hands-on experience deploying applications that leverage critical security features of the Nutanix Cloud Platform (NCP). At the end of this lab, you will be able to:</p> <ul> <li>Understand and demonstrate the security features that can help prevent, detect, and recover from ransomware incidents.</li> <li>Explain the security-specific value of the various components.</li> <li>Illustrate why Nutanix is one of the best-performing and most secure platforms for their data and applications.</li> </ul>"},{"location":"#time","title":"Time","text":"<p>You will have 110 minutes to complete the security lab exercises.</p>"},{"location":"environment_details/","title":"Environment Details","text":"<p>Nutanix Bootcamps are intended to be run within the Nutanix Hosted POC (HPOC) environment. Your cluster contains all the necessary images, networks, and VMs to complete the exercises.</p> <p>Danger<p>Do not perform any upgrades to the environment. This includes, but is not limited to, Prism Element (PE), Prism Central (PC), Acropolis Operating System (AOS), Nutanix Cluster Check (NCC), Foundation, any hardware-specific updates (ex. firmware), and any software within any remote sessions (ex. Graylog, Linux packages, PuTTY, Sublime Text).</p> <p>Doing so will negatively impact your lab experience and potentially any other attendees using this cluster.</p> </p>"},{"location":"environment_details/#initial-connection-and-configuration","title":"Initial Connection And Configuration","text":""},{"location":"environment_details/#nutanix-employees","title":"Nutanix Employees","text":"<ul> <li>Choose VPN (Global Protect) or VDI (Frame, Parallels) unless otherwise specified.</li> <li>Log in using the credentials listed in the X-Labs VDI/VPN Connection Information section.</li> </ul>"},{"location":"environment_details/#non-nutanix-employees","title":"Non-Nutanix Employees","text":"<ul> <li>Choose VPN (Ivanti) or VDI (Frame, Parallels) unless otherwise specified.</li> <li>Log in using the credentials listed in the X-Labs VDI/VPN Connection Information section.</li> </ul>"},{"location":"environment_details/#vdi","title":"VDI","text":""},{"location":"environment_details/#vdi-connection-options","title":"VDI Connection Options","text":"<p>Parallels</p> <ol> <li> <p>Log in here.</p> </li> <li> <p>Click on the Profile icon, and choose Download Client.</p> </li> <li> <p>Click the Download button for your operating system.</p> </li> <li> <p>Run the Parallels installation.</p> </li> <li> <p>Click Install Basic Client.</p> </li> <li> <p>Launch Parallels Client.</p> </li> <li> <p>Accept the EULA.</p> </li> <li> <p>When prompted with You have no RAS Connection configured, would you like to add one now?, click Yes.</p> </li> <li> <p>Enter <code>phx-ras.xlabs.nutanix.com</code> in the field, and click Next &gt; Next.</p> </li> <li> <p>Fill out the Username: and Password: fields, and click Connect.</p> </li> <li> <p>Right-click on the X-Labs - PHX entry, and click Connect.</p> </li> </ol> <p>Frame 1. Log in here.</p> <ol> <li> <p>Enter your Username, click Next, enter your Password, and click Next.</p> </li> <li> <p>Click on Desktop.</p> </li> </ol>"},{"location":"environment_details/#vdi-monitor-configuration-recommendations","title":"VDI Monitor Configuration Recommendations","text":"<ul> <li>Additional monitor: Lab instructions.</li> <li>Your laptop's monitor: VDI session. Your sessions will be initiated from here (ex., Remote Desktop, SSH).</li> </ul> <p>Warning<p>Always use applications within the remote session. Otherwise, the version you use may look or operate differently and could negatively impact your ability to complete the lab in the time allotted. Additionally, this aids with handling downloaded files, as all downloaded files would be within the remote session.</p> </p>"},{"location":"environment_details/#vpn","title":"VPN","text":""},{"location":"environment_details/#vpn-connection-options","title":"VPN Connection Options","text":"<p>Ivanti Connect Secure VPN Client</p> <ol> <li> <p>If the client is already installed, skip to step 5.</p> </li> <li> <p>To download the client, log in here.</p> </li> <li> <p>Click Start &gt; Download to begin downloading the client.</p> </li> <li> <p>Click HERE to continue the installation.</p> </li> <li> <p>Check the box Always allow https://phx-vpn.xlabs.nutanix.com to open pulsesecure links and click Yes &gt; Yes &gt; Yes. The client download and installation will now proceed.</p> </li> <li> <p>Click Yes &gt; Yes &gt; Yes. The client will now open, and you are now connected.</p> </li> </ol>"},{"location":"environment_details/#vpn-monitor-configuration-recommendations","title":"VPN Monitor Configuration Recommendations","text":"<ul> <li>Additional monitor: Lab instructions.</li> <li>Your laptop's monitor: Your Remote Desktop session will be initiated from here</li> </ul> <p>Warning<p>Always use applications within the remote session. Otherwise, the version you use may look or operate differently and could negatively impact your ability to complete the lab in the time allotted. Additionally, this aids with handling downloaded files, as all downloaded files would be within the remote session.</p> </p>"},{"location":"environment_details/#conventions-used-in-this-lab","title":"Conventions Used In This Lab","text":"<ol> <li> <p>Italics - Replace with a value from your environment (ex., replace PRISM-CENTRAL-IP-ADDRESS with the Prism Central IP address from your assigned cluster.)</p> </li> <li> <p><code>Code</code> - Text you must enter, whether copy and paste or manually input (ex. Type <code>thisisunsafe</code>.)</p> </li> <li> <p>Bold - Used to differentiate adjacent text. (ex. Name - Saul Goodman.)</p> </li> <li> <p>Highlight - A named entry you will click on (ex. Click Advanced.)</p> </li> <li> <p>Links - Added for additional contexts, such as an acronym (ex. CISO) or software downloads (ex. PuTTY)</p> </li> <li> <p>:fa-caret-right: (caret right) - Text or image that is initially hidden but can be expanded by clicking directly on the :fa-caret-right:.</p> <p> Ex. Click here to see a picture of my cat <p>Aren't you glad you clicked? Isn't she just the sweetest?</p> <p></p>"},{"location":"environment_details/#know-before-you-go","title":"Know Before You Go","text":"<ul> <li>Unless otherwise specified, credentials are listed on the Tech Summit 2023 landing page.</li> <li>Never use the information within screenshots in your environment. Screenshots are shown for illustration purposes only (ex., IP addresses.)</li> <li>Ignore any IP addresses that resemble 169.254.###.###.</li> <li>Throughout the lab, you will see the usage of ## (ex. User##). Replace the ## with your assigned number on the Tech Summit 2023 landing page. For example:<ul> <li>Active Directory user - adminuser01@ntnxlab.local</li> <li>Windows Tools VM: User01-WinTools</li> <li>VDI/VPN: DM3-POC020-User04</li> </ul> </li> <li>The cluster's time zone is UTC (previously GMT).</li> <li>Las Vegas, NV - PDT = UTC -8</li> <li>Singapore - SGT = UTC +8</li> <li>Paris, France - CET = UTC +1</li> <li>If instructed to:<ul> <li>SSH (Secure Shell) - Use PuTTY within your Remote Desktop session</li> </ul> </li> <li>Remote Desktop, Remote Desktop Protocol (RDP), or Remote Desktop Connection (RDC)<ul> <li>Mac - Microsoft Remote Desktop</li> <li>Windows - Remote Desktop Connection (built-in) on Windows using Start Menu &gt; Remote Desktop Connection</li> </ul> </li> <li>It is highly recommended to use Chrome. Using other browsers may present unexpected results and consume your allotted time. If you are presented with a security warning in Chrome, use one of the following methods to proceed. </li> <li>Chrome (method 1)<ol> <li>Click Advanced.   </li> <li>Click on any blank section within the main browser window.</li> <li>Type <code>thisisunsafe</code>. Note: the text you type will not be visible.   </li> </ol> </li> <li>Chrome (method 2)<ol> <li>Click ^^Advanced^^   </li> <li>Click Proceed to IP-ADDRESS (unsafe).   </li> </ol> </li> </ul>"},{"location":"environment_details/#a-request-before-you-begin","title":"A Request Before You Begin","text":"<p>We kindly ask for the following, as we want to ensure that everyone has the most impactful experience possible. Tech Summit only happens once a year, and for a great many folks it's one of the few times they have dedicated time with hands-on labs. We know how easy it is to get distracted.</p> <p>Thank you very much for your attention and cooperation. We hope you enjoy your experience with us today!</p> <ul> <li>Turn off all alerts (including vibration) on cell phones, laptops, watches, or other devices.</li> <li>Disable any notifications on your laptop (ex. Slack, e-mail.)</li> <li>If you choose to use headphones or similar, please ensure they are at a volume that doesn't disturb other attendees.</li> </ul>"},{"location":"chapter1/chapter1/","title":"Platform Security","text":""},{"location":"chapter1/chapter1/#chapter-1-platform-security","title":"Chapter 1: Platform Security","text":"<p>Welcome to the Secure the Nutanix Cloud Platform (NCP) hands-on lab. Security is more than firewalls and encryption. This lab aims to show how all parts of the NCP contribute to deploying a secure cloud. You'll learn to configure security at all layers, including platform, data, network, and application.</p> <p>Nutanix delivers a secure platform that integrates with standards-based customer systems. The platform is the core infrastructure on which everything else is based. In this chapter, you'll configure the platform and infrastructure components.</p>"},{"location":"chapter1/chapter1/#logging-and-auditing","title":"Logging and Auditing","text":"<p>If it's not written down, did it happen? Can you prove that to an auditor or an investigator? Logging and auditing are built into Nutanix, so use them to prove who did what and when. Logs are great for troubleshooting but critical for incident response.</p> <p>In this lab, we've deployed a Graylog server on each cluster to collect and display logs generated by the Nutanix cluster.</p>"},{"location":"chapter1/chapter1/#configure-syslog-on-prism-central","title":"Configure Syslog on Prism Central","text":"<p>Warning<p>Making syslog module changes in the Prism Central web interface may erase the Command Line Interface (CLI) changes you are about to make. Do not use the Prism Central web interface to set syslog modules in this lab.</p> </p> <p>Note<p>Before you start doing the labs, note the following Active Directory user names.</p> <p>Get your username from <code>Lab GTS23- Secure</code> section the HPOC lookup, </p> <p>E.g: if your username is <code>PHX-POC218-User01</code>, then <code>##</code> represents <code>01</code></p> <ul> <li>adminuser<code>##</code> becomes adminuser<code>01</code></li> <li>operator<code>##</code> becomes operator<code>01</code> </li> </ul> <p>Throughout the lab, replace ## with your appropriate user number. </p> </p> <ol> <li> <p>Log into Prism Central.</p> <ul> <li>username - <code>adminuser##@ntnxlab.local</code> (##is your user number)</li> <li>password - <code>nutanix default</code> </li> </ul> </li> <li> <p>Navigate to  &gt; Compute &amp; Storage &gt; VMs. Look for VMs named Graylog and User##-WinTools. Make note of both IP addresses within the IP Addresses** column.</p> <p>We\u2019ll use Graylog to receive audit and syslog events from the cluster.</p> </li> <li> <p>Open Remote Desktop </p> </li> <li> <p>From within the Tools folder on the desktop, open PuTTY.</p> </li> <li> <p>Within the Specify the destination you want to connect to section, enter <code>nutanix@PRISM-CENTRAL-IP-ADDRESS</code> in the Host Name (or IP address) field. Click Open. When prompted for a password enter <code>nutanix default</code>.</p> <p></p> <p>Tip</p> <p>If you can't log in via SSH, within Prism Central, navigate to  &gt; Settings &gt; Cluster Lockdown. Ensure that Enable Remote Login with Password is checked.</p> </li> <li> <p>Execute the following commands. These can be entered separately, or all at once.</p> <pre><code>ncli\n</code></pre> <pre><code>rsyslog-config list-servers\n</code></pre> <pre><code>rsyslog-config list-modules server-name=ClusterLog\n</code></pre> <p>If you receive this output, proceed to the Once Per Table note below. </p> <p>If you receive this output, proceed to Configure Syslog on Prism Element. </p> <p>Once Per Table<p>Only one person per table needs to run the following steps. If you're missing the ClusterLog server or FLOW, AUDIT, PRISM, and SYSLOG_MODULE in the list, enter the following.</p> <p>Be sure to replace GRAYLOG-IP-ADDRESS with your Graylog IP address, before pressing Enter.</p> <pre><code>ncli\n</code></pre> <pre><code>rsyslog-config add-server name=ClusterLog ip-address=GRAYLOG-IP-ADDRESS port=10514 network-protocol=udp relp-enabled=false\n</code></pre> <pre><code>rsyslog-config add-module server-name=ClusterLog module-name=FLOW level=INFO include-monitor-logs=false\n</code></pre> <pre><code>rsyslog-config add-module server-name=ClusterLog module-name=AUDIT level=INFO include-monitor-logs=false\n</code></pre> <pre><code>rsyslog-config add-module server-name=ClusterLog module-name=PRISM level=INFO include-monitor-logs=false\n</code></pre> <pre><code>rsyslog-config add-module server-name=ClusterLog module-name=SYSLOG_MODULE level=info include-monitor-logs=false\n</code></pre> <p></p> </p> </li> <li> <p>Exit your SSH session.</p> </li> </ol>"},{"location":"chapter1/chapter1/#configure-syslog-on-prism-element","title":"Configure Syslog on Prism Element","text":"<p>Warning<p>Making syslog module changes in the Prism Element web interface may erase the Command Line Interface (CLI) changes you are about to make. Do not use the Prism Element web interface to set syslog modules in this lab.</p> </p> <ol> <li> <p>From within the Tools folder on the desktop, open PuTTY.</p> </li> <li> <p>Within the Specify the destination you want to connect to section, enter <code>nutanix@PRISM-ELEMENT-IP-ADDRESS</code> in the Host Name (or IP address) field. Click Open. When prompted for a password enter <code>gts23TechX!</code>.</p> <p></p> </li> <li> <p>Execute the following commands to verify that the syslog server is present within Prism Element. These can be entered separately, or all at once.</p> <pre><code>ncli\n</code></pre> <pre><code>rsyslog-config list-servers\n</code></pre> <pre><code>rsyslog-config list-modules server-name=ClusterLog\n</code></pre> <p>If you receive this output, proceed to the Once Per Table note below. </p> <p>If you receive this output, proceed to Syslog Verification. </p> <p>Once Per Table<p>If the ClusterLog server or FLOW module is missing, enter these commands to set up Security Policy Hit Logs on the Prism Element cluster. These can be entered separately, or all at once.</p> <p>Be sure to replace GRAYLOG-IP-ADDRESS with your Graylog IP address, before pressing Enter.</p> <pre><code>rsyslog-config add-server name=ClusterLog ip-address=GRAYLOG-IP-ADDRESS port=10514 network-protocol=udp relp-enabled=false\n</code></pre> <pre><code>rsyslog-config add-module server-name=ClusterLog module-name=FLOW level=INFO include-monitor-logs=false\n</code></pre> <p></p> </p> </li> <li> <p>You may close your SSH session. However, leave the Remote Desktop session active.</p> </li> </ol>"},{"location":"chapter1/chapter1/#syslog-verification","title":"Syslog Verification","text":"<p>First, we'll generate some events that will cause logs to be sent to our syslog server.</p> <ol> <li> <p>Within Prism Central, navigate to  &gt; Compute &amp; Storage &gt; VMs.</p> </li> <li> <p>Select User##-WinTools by checking the adjacent box.</p> </li> <li> <p>Click Actions &gt; Manage Categories. You may need to scroll down to see this entry.</p> </li> </ol> <p></p> <ol> <li> <p>In the Search field type <code>Tenant: User##</code>, select the Tenant: User## category, and click Save.</p> <p>These changes won't affect the VM since there are no policies in effect yet. However, you will see the changes we made to the VM's category created an auditable event. Let's find it!</p> </li> <li> <p>Open your browser, enter <code>http://GRAYLOG-IP-ADDRESS:9000</code>, and press the Enter key. Log in with the following credentials:</p> </li> <li>Username - <code>admin</code></li> <li> <p>Password - <code>nutanix default</code></p> </li> <li> <p>Click Streams &gt; All Messages.</p> </li> </ol> <p></p> <ol> <li> <p>Within the time range drop-down, select Search in the last 30 minutes. Enter the search term <code>consolidated_audit</code> and press the Enter key. The audit logs will show which VM was changed and who made the change. You will also see their differences if there are other users on this cluster.   </p> </li> <li> <p>Perform the following within your Remote Desktop session. This time you are going to enter the incorrect password intentionally.</p> <ul> <li>Open PuTTY. Within the Specify the destination you want to connect to section, enter <code>hacker@PRISM-CENTRAL-IP-ADDRESS</code> in the Host Name (or IP address) field. Click Open. When prompted for a password enter <code>12345</code>.   </li> <li>Once complete, you may close your PuTTy session.</li> </ul> </li> <li> <p>Repeat the search in Graylog, this time entering <code>\"Failed password\"</code> (including the quotes) within the search field.</p> <p></p> </li> <li> <p>Within the Messages section, you will see an entry with NTNX-PC-IP-ADDRESS-A-PCVM similar to the below.</p> <p></p> </li> </ol>"},{"location":"chapter1/chapter1/#role-based-access-control-rbac","title":"Role-Based Access Control (RBAC)","text":"<p>RBAC is critical in multiple tenets and pillars of the Zero Trust Architecture (ZTA). What if one key could open every door? Everyone who possessed a copy of this key could open any locked door regardless of their need or requirement to access what is behind it. This discretionary access is analogous to responding to all access requests by assigning full administrator privileges, regardless of their functional administrative responsibility. This method of assigning access is a significant security risk. An administrator can accidentally change or remove something they had no business accessing, causing disruption and potential downtime.</p> <p>Today, we can assign cluster administrators to one or more roles that restrict access to only what is needed for their specific job responsibilities. We can use system-defined roles or even create new roles to determine which elements a user can access and the type of access for each of those elements.</p> <p>In this lab, we will assign a user to a system-defined role. This user will have a role that aligns with their job responsibilities. We will use entity filters when assigning a user to a role to restrict further the user's access to the elements necessary to perform their duties.</p> <p>We'll start with the highest privilege user, adminuser##, who can manage these roles and assign them to others.</p> <ol> <li> <p>Navigate to  &gt; Administration &gt; Roles.</p> </li> <li> <p>Click directly on the Operator role.</p> </li> <li> <p>Select Manage Assignment from the top menu bar.</p> </li> </ol> <p></p> <ol> <li> <p>Click Add New.</p> <ul> <li> <p>Within the Select Users or User Groups or OUs section, enter <code>operator##</code> into the Search User field, and select the entry. We will assign this user fewer permissions than adminuser##.</p> </li> <li> <p>Within the Select Entities section, select AHV VM from the Entity type drop-down.</p> </li> <li> <p>Select In Cluster from the Condition drop-down.</p> </li> <li> <p>Enter <code>POC</code> within the Search Cluster field, and select your cluster (ex. PHX-POC088.)</p> </li> <li> <p>Click Save.</p> </li> </ul> <p></p> </li> <li> <p>Click the :fa-x: in the top-right corner.</p> </li> <li> <p>Select Sign Out from the username drop-down (in this case Adminuser##) located in the upper right corner.</p> </li> <li> <p>Log into Prism Central.</p> <ul> <li>username - <code>operator##@ntnxlab.local</code></li> <li>password - <code>nutanix default</code></li> </ul> </li> <li> <p>Navigate to  &gt; Data Protection.</p> <p>Which actions can this user perform? This user's access has been restricted, and we can add more permissions through the roles and assignments if needed.</p> <p> Open After Performing The Above <p>This screenshot illustrates what you should see.</p> <p></p> <li> <p>Select Sign Out from the username drop-down (in this case Operator##) located in the upper right corner.</p> </li>"},{"location":"chapter1/chapter1/#ui-timeouts","title":"UI Timeouts","text":"<p>Have you ever walked by an empty workstation and noticed it was unlocked? Timeouts ensure that sessions close when they are no longer in use, preventing unauthorized access and reducing the exposure to potential unauthorized access and data breaches. While it is common for organizations to enforce such timeouts for workstations and laptops, ensuring this is done for administrative connections to a cluster is essential to protect your environment.</p> <p>Info</p> <p>The below steps are for illustration purposes only. There are no changes for you to make.</p> <ol> <li> <p>Log into Prism Central.</p> <ul> <li>username - <code>adminuser##@ntnxlab.local</code></li> <li>password - <code>nutanix default</code></li> </ul> </li> <li> <p>Navigate to  &gt; Prism Central Settings. You may need to scroll down to see this entry.</p> </li> <li> <p>Select UI Settings from within the Appearance section. You may need to scroll down to see this entry.</p> </li> </ol> <p></p> <p>It is recommended to select the minimum timeout values and deny override.</p>"},{"location":"chapter1/chapter1/#cluster-lockdown-and-ssh-keys","title":"Cluster Lockdown and SSH Keys","text":"<p>Did you know you can enable SSH passwordless login to your Nutanix clusters?</p> <ul> <li>Ensures passwords do not need to be sent over the network</li> <li>Resistant to brute force attacks</li> <li>Decreases the risk of exposed login credentials</li> </ul> User Public Key Private Key User Public Key Private Key User01 User01  Public Key User01 Private Key User06 User06  Public Key User06 Private Key User02 User02  Public Key User02 Private Key User07 User07  Public Key User07 Private Key User03 User03  Public Key User03 Private Key User08 User08  Public Key User08 Private Key User04 User04  Public Key User04 Private Key User09 User09  Public Key User09 Private Key User05 User05  Public Key User05 Private Key User10 User10  Public Key User10 Private Key <p>Both keys are provided for this lab to eliminate the typical process for creating keys, considering the limited time allotted for the lab.</p> <p>Tip</p> <ul> <li>Your public key is named User##Public.txt and your private key is named User##Private.ppk.</li> <li>Clicking User## Public Key will open a new tab, displaying the contents of the file.</li> <li>Clicking User## Private Key will download the file.</li> </ul> <ol> <li> <p>Return to your Remote Desktop session. Log into Prism Central.</p> <ul> <li>username - <code>adminuser##@ntnxlab.local</code></li> <li>password - <code>nutanix default</code></li> </ul> </li> <li> <p>Navigate to  &gt; Prism Central Settings. From the Security section, select Cluster Lockdown. You may need to scroll down to see this entry.</p> </li> <li> <p>Click on your User## Public Key from the table above. Copy the entire text.</p> </li> <li> <p>Click :fa-plus: New Public Key. Fill out the following fields, and click Save.</p> <ul> <li>Name - <code>User##</code></li> <li>Key - Paste your public key into they Key field   </li> </ul> </li> <li> <p>Click Cluster Lockdown and SSH Keys. Right-click on your User##Private.ppk entry in the table, and choose Copy Link.</p> </li> <li> <p>Within your Remote Desktop session, open a new browser tab, paste the link, and press Enter.</p> </li> <li> <p>Right-click on a blank section of the main browser window, and choose Save As.... Choose the Downloads, and click Save.</p> </li> <li> <p>Open PuTTy.</p> </li> <li> <p>Within the Connection section in the left pane, expand SSH, and click Auth.</p> </li> <li> <p>Within the Authentication parameters click Browse. Click on the Downloadsfolder. Select your private SSH Key User##Private.ppk, and click Open.</p> <p></p> </li> <li> <p>Click on Session. Within the Specify the destination you want to connect to section, enter <code>nutanix@PRISM-CENTRAL-IP-ADDRESS</code> in the Host Name (or IP address) field.</p> </li> <li> <p>Within the Load, save or delete a stored session section, enter <code>Prism Central</code> within the Saved Sessions field, and click Save.</p> <p></p> <p>Now that your Public Key has been uploaded to Prism Central, and you've configured PuTTY, let's test SSH passwordless login.</p> </li> <li> <p>Ensure the Prism Central entry is highlighted, and click Open. You will be connected to Prism Central without being prompted for a password.</p> <p></p> </li> </ol>"},{"location":"chapter1/chapter1/#nutanix-vulnerability-database","title":"Nutanix Vulnerability Database","text":"<p>As part of your mandate from the CIO, you've been tasked with finding a resolution to CVE-2021-4034. Nutanix Vulnerability Database (NXVD) on the Nutanix Support Portal is an excellent resource for finding more information about this CVE. For this lab, we'll show you the process for reference, so you can be familiar with it when you perform these steps yourself.</p> <p>Nutanix Vulnerability Database demo.</p> <p>The solution to this vulnerability is an update we can implement via LCM (Life-Cycle Manager.)</p> <p>Follow this LCM demo to see how easy that process can be.</p>"},{"location":"chapter1/chapter1/#security-dashboard","title":"Security Dashboard","text":"<p>What if there was a way to manage platform security features in one place, giving you visibility and ease of configuration? The Prism Security Dashboard does just that in Prism Central 2022.9 and AOS 6.6, which we recently released.</p> <p>Follow this Prism Security Dashboard demo to see the new Prism Security Dashboard in action.</p>"},{"location":"chapter1/chapter1/#default-passwords","title":"Default Passwords","text":"<p>Warning<p>These steps are provided as informational only. Do not execute these steps in this lab. Additionally, KB-6513 can be used to guide you through the process in your production environment.</p> </p> <p>Nutanix released Security_advisory_0011 and a corresponding NCC health check which will generate a critical alert for default passwords. It is highly recommended to change the default passwords of the CVMs, Prism Central, AHV hosts, and other components during the initial installation process.</p>"},{"location":"chapter1/chapter1/#ssl-certificates","title":"SSL Certificates","text":"<p>As part of this lab, let's go through a quick SSL Certificate Replacement demo based on Prism Central. In this demo, we use a self-signed certificate. However, your production environment would obtain a certificate from a Certificate Authority (CA). In production, you would also repeat these steps on every connected Prism Element cluster.</p>"},{"location":"chapter2/chapter2/","title":"Chapter 2: Data Security","text":""},{"location":"chapter2/chapter2/#primary-storage-data-protection","title":"Primary Storage Data Protection","text":""},{"location":"chapter2/chapter2/#encryption","title":"Encryption","text":"<p>Data-at-Rest Encryption (DARE) encrypts  data when it is stored on disk (i.e., not while active within a system's memory).</p> <p>DARE is an essential element within a security strategy because it prevents data from being recovered from a decommissioned cluster. To anyone without the keys, the data is scrambled. </p> <p>Nutanix DARE can be deployed using an external key manager or our built-in native key manager. Encryption can be applied in hardware with Self-Encrypting Drives (SED) or in software with non-SED drives. You can even encrypt the entire cluster, storage containers, or per-VM using Storage Policies. </p> <p>The lab cluster is already licensed for encryption. We will use per-VM, or entity and policy-based encryption to support multi-tenancy in this shared lab environment. Most customers will just use cluster-based encryption which requires less configuration.</p> <p>Once Per Table<p>Only one user per table needs to perform this step.:::</p> </p> <ol> <li> <p>Navigate to Prism Central and Select  &gt; Hardware &gt; Clusters.</p> </li> <li> <p>Select your cluster by clicking the check box.</p> </li> </ol> <p>:::tip Already Encrypted? If your cluster is already encrypted, click Actions &gt; Manage &amp; Backup Keys, and proceed to step 7. :::</p> <ol> <li>Click Actions &gt; Enable Data-at-Rest Encryption. </li> </ol> <p></p> <ol> <li> <p>Select Entity Encryption, and click Save Encryption Type.</p> </li> <li> <p>Ensure Native KMS (Local) is selected, and click Enable Encryption.</p> </li> <li> <p>Type <code>SET</code> in the confirmation window, and click Set Encryption.</p> </li> <li> <p>Before encrypting any VMs, it is recommended to back up the encryption keys somewhere safe.</p> </li> <li> <p>Click Backup Keys.</p> </li> <li> <p>Enter <code>nutanix default</code> within both the Password and Confirm Password fields. Click Backup Key. A download will begin for a .zip file containing your backup key, which allows you to recover the encryption key. Click Close.</p> </li> </ol>"},{"location":"chapter2/chapter2/#encrypting-with-storage-policies","title":"Encrypting With Storage Policies","text":"<p>Next, we'll configure Storage Policies that can apply to specific sets of VMs or even individual VMs based on category.</p> <ol> <li> <p>Navigate to  &gt; Compute &amp; Storage &gt; Storage Policies.</p> </li> <li> <p>Click :fa-plus: Create Storage Policy. Fill out the following fields.</p> <ul> <li>Name - <code>User##-StoragePolicy</code></li> <li>Within the Encryption section, choose Enabled from the Value drop-down.</li> </ul> </li> <li> <p>Click Next.</p> </li> <li> <p>Type <code>Tenant: User##</code> within the Add Category field. Select the Tenant: User## entry from the list, and click Save.</p> </li> </ol> <p></p> <pre><code>Now all VMs assigned the category **Tenant: User##** will be encrypted as this policy is enforced. Let's test this out with **User##-WinTools**, which we had assigned the **Tenant: User##** category in Chapter 1.\n</code></pre> <ol> <li> <p>Navigate to  &gt; Compute &amp; Storage &gt; VMs.</p> </li> <li> <p>Right-click on User##-WinTools, and choose Clone.</p> </li> <li> <p>Enter <code>User##-WinTools-Clone</code> within the Name field, and click Next &gt; Next &gt; Next &gt; Clone VM.</p> </li> <li> <p>Once the clone has been created, click directly on User##-WinTools-Clone.</p> </li> <li> <p>Refer to the Storage Properties pane. Is your VM encrypted?</p> <p></p> <p>This method allows you to choose which individual VMs are encrypted without encrypting the entire cluster.</p> </li> <li> <p>Choose Power On from the More drop-down.</p> </li> </ol>"},{"location":"chapter2/chapter2/#snapshots","title":"Snapshots","text":"<p>Snapshots create a local point-in-time recovery option that can act as a first-line defense for ransomware or data loss protection. They can also be handy for incident response and other investigations. We'll create snapshots that can act as an \"undo\" if you need to restore from a minor incident. </p> <ol> <li> <p>Navigate to  &gt; Data Protection &gt; Protection Policies.</p> </li> <li> <p>Click Create Protection Policy. Fill out the following fields.</p> <ul> <li>Policy Name - <code>User##-LocalProtectionPolicy</code></li> <li>Select your cluster from the Cluster drop-down, and click Save.</li> </ul> </li> <li> <p>Within the Primary Location section, click :fa-plus: Add Local Schedule &gt; Save Schedule.</p> </li> <li> <p>Within the Recovery Location section, click Cancel, as we aren't replicating to a remote location within this lab.</p> </li> <li> <p>Click Next.</p> </li> <li> <p>Within the Categories section, check the box adjacent to Tenant: User##, and click Add.</p> </li> <li> <p>Click Create.</p> <p>Every VM within your Tenant: User## category will be protected by the local protection policy you just created.</p> </li> <li> <p>We will verify that these snapshots are being created as expected. Navigate to  &gt; Compute &amp; Storage &gt; VMs.</p> </li> <li> <p>Click directly on User##-WinTools.</p> </li> <li> <p>Click Recovery Points from the top menu bar to view the recent snapshots. Note: It can take a few minutes for these to show up in the UI. Take advantage of this time to stand up and stretch. You probably need it at this point! </p> </li> <li> <p>Check the box adjacent to User##-WinTools, and click Actions &gt; Clone to create a new VM from snapshot. For brevity, you created a Crash Consistent snapshot, which does not restore the memory state of the VM. However, this enables you to restore to a point before a known incident.</p> </li> <li> <p>Leave the New VM Name as default, and click Clone.</p> <p>Snapshots are a vital part of your security plan. However, since they are typically stored on the same cluster as the original VMs, you should always rely on protecting your workloads outside of snapshots. If the cluster is compromised or unavailable, so are the snapshots. We need a method that makes a copy of our data off-cluster.</p> </li> </ol>"},{"location":"chapter2/chapter2/#backups","title":"Backups","text":"<p>Backups play a vital role in security. Keeping a secured set of offline backups that exist separately from the primary storage gives you more robust recovery options in the event of a security incident. These methods may even be required to meet the standards of particular industries.</p> <p>Nutanix works with a wide range of backup partners. While we did not include backup exercises in this lab, we suggest you Take a Backup Test Drive demonstrating Nutanix Mine in the future.</p>"},{"location":"chapter2/chapter2/#unified-storage-data-services","title":"Unified Storage (Data Services)","text":"<p>Now that you've secured your infrastructure platform let's show how Nutanix Data Lens and Nutanix Objects can protect your unstructured data. As these services are part of the Nutanix Cloud Platform, they benefit from the security features we've seen here: Data-At-Rest Encryption, snapshots, and backups.</p>"},{"location":"chapter2/chapter2/#nutanix-data-lens","title":"Nutanix Data Lens","text":"<p>In our example scenario, the customer development team utilizes a shared file server for their applications. They've chosen Nutanix Files and are wondering what sort of ransomware protections might be built to prevent a compromised development machine from disrupting their environment.</p> <p>Let's consider a scenario where you detect ransomware in your file share, which is a potential blocker for an upcoming product launch. </p> <p>Nutanix Data Lens  can help. View the Nutanix Data Lens Demo to see how we detect ransomware and block malicious access.</p>"},{"location":"chapter2/chapter2/#nutanix-objects","title":"Nutanix Objects","text":"<p>Nutanix Objects has supported AWS S3-compliant WORM (Write Once Read Many) for some time. With Objects 2.0, customers may now use WORM with non-versioned buckets.</p> <p>Follow along in this Nutanix Objects WORM Demo to see how easy it is to create, secure, and selectively share buckets with our users. </p>"},{"location":"chapter3/chapter3/","title":"Chapter 3: Network and Application Security","text":"<p>So far, you've learned how to secure the platform and data. Now we need to secure our applications and networking. Traditionally, applications have been secured at a layer 2 (VLAN) boundary, where data is filtered at the ingress/egress of the VLAN. However, layer 2 filtering allows all traffic between hosts within the same VLAN. When new applications are spun up, they are assigned to a VLAN, ingress/egress rules are updated, and the application is \"on the wire.\"</p> <p>What happens if one of these hosts in the VLAN is compromised? It means that all the VMs on the same VLAN are exposed and at an elevated risk for compromise. There is nothing natively restricting traffic within this VLAN. The solution is to deploy applications with security in place from day one, update existing applications with more granular security policies, then monitor your environment. In this section, we will use NCM Self-Service to deploy our applications securely using projects and multi-tenancy. We will then use Security Central to discover our newly deployed application's data flows. Finally, we'll use Flow Network Security and microsegmentation to secure our application inside the VLAN.</p>"},{"location":"chapter3/chapter3/#multi-tenancy-projects-and-rbac","title":"Multi-tenancy: Projects and RBAC","text":"<p>Customers are always searching for ways to increase security by limiting what users can access. In the past, multi-tenancy was relevant to service providers and a few enterprise customers. Now customers of all shapes and sizes are looking at multi-tenancy to add a layer of security. Multi-tenancy helps protect business units from one another and specific projects from leaking into other areas. You may safeguard applications from one another when adding layers of roles and responsibilities that multi-tenancy provides.</p> <p>This section will show how deploying Projects with NCM Self-Service can help customers implement multi-tenancy. Customers can deploy tenant-managed applications with security in place from launch. </p> <p>This pre-created Blueprint has security best practices and categories set by default. Hence, all you have to do is publish it for the tenant. Then the tenant clicks Launch.</p> <p>To save you lab time, we've created the Projects and Blueprints.</p> <ol> <li> <p>Navigate to  &gt; Services &gt; Calm &gt; Projects &gt; </p> </li> <li> <p>Click the Project Tenant##.</p> </li> <li> <p>Click Users &amp; Groups within the top menu.</p> <p>Note: we've added consumer## to this project already.</p> </li> <li> <p>Click Add/Edit Users and Groups.</p> <p>What role does the consumer## user have? You worked with these RBAC roles earlier in the lab.</p> </li> <li> <p>Close this window by clicking the :fa-x:.</p> </li> <li> <p>Navigate to  &gt; Services &gt; Calm &gt; Blueprints. </p> </li> <li> <p>Check directly on User##-DeployFiestaApp.</p> </li> <li> <p>Click Publish.</p> </li> <li> <p>Select Publish with secrets, and enter <code>1.0.0</code> within the Initial Version field. Click Submit for Approval.</p> </li> </ol> <p></p> <ol> <li> <p>Navigate to the Marketplace Manager. </p> </li> <li> <p>Click Approval Pending from the top menu.</p> </li> <li> <p>Select the check box adjacent to User##-DeployFiestaApp.</p> </li> <li> <p>Within the Projects Shared With drop-down, select your Tenant## Project.</p> </li> <li> <p>Within the Category dropdown, select DevOps.</p> </li> <li> <p>Click the Approve check mark.</p> </li> <li> <p>Click Approved from the top menu.</p> </li> <li> <p>Search for and select your User##-DeployFiestaApp by typing <code>User##</code> within the Type here to apply filters field, and pressing Enter. Select the check box adjacent to User##-DeployFiestaApp.</p> </li> <li> <p>Click Publish.</p> </li> <li> <p>Select Sign Out from the username drop-down (in this case Adminuser##) located in the upper right corner.</p> </li> </ol>"},{"location":"chapter3/chapter3/#repeatable-security-ncm-self-service","title":"Repeatable Security: NCM Self-Service","text":"<p>You'll now connect to Prism Central as a limited privilege tenant consumer user who can launch applications but can't change security settings. When this consumer user launches a blueprint, all categories and policies are pre-configured. Your application will be secure by default right as it's deployed. This example launches a simple app that has a web and database component.</p> <ol> <li> <p>Log into Prism Central.</p> <ul> <li>username - <code>consumer##@ntnxlab.local</code></li> <li>password - <code>nutanix default</code></li> </ul> </li> <li> <p>Navigate to  &gt; Calm &gt; Marketplace. </p> </li> <li> <p>Within the Search marketplace field enter <code>user##</code>, and click Get.</p> <p></p> </li> <li> <p>Click Launch. Fill out the following fields, and click Deploy.</p> <ul> <li>Application Name <code>User##-FiestaApp</code></li> <li>Initials - <code>User##</code> </li> </ul> <p>Your application will take a few minutes to deploy. Let's use this time to demonstrate Security Central, which will discover the application's communication flows and provide suggestions on how best to secure the application.</p> </li> </ol>"},{"location":"chapter3/chapter3/#security-planning-with-security-central","title":"Security Planning With Security Central","text":"<p>Getting the right microsegmentation policy for your infrastructure takes time, especially if you have many VMs. You may need to involve multiple teams to identify ports, IPs, security approvals, and application owners.</p> <p>Nutanix Security Central simplifies microsegmentation policy creation with Security Planning by collecting Internet Protocol Flow Information Export (IPFIX records. Based on this collected data, Security Planning learns which VMs communicate and recommends groups and policies with machine-learning algorithms. </p> <p>Follow along in this Security Central Security Planning demo to see how we can easily visualize and securely the newly created Fiesta application.</p>"},{"location":"chapter3/chapter3/#microsegmentation-with-flow-network-security","title":"Microsegmentation with Flow Network Security","text":"<p>We have shown how Security Central can help you examine your applications and plan our security policies. Now, let's check on the status of our application deployment.</p> <ol> <li> <p>Navigate to  &gt; Compute &amp; Storage &gt; VMs. You will see the VMs created and used by your FiestaApp. Notice you only see VMs associated with your Project. You will not see any VMs created by other projects or users since consumer##@ntnxlab.local has limited permissions.</p> <p></p> </li> <li> <p>Note the IP address of User##-WebServer.</p> </li> <li> <p>Open a new browser tab, type <code>http://FIESTA-WEBSERVER-IP</code>, and press Enter. Spend a few moments to purchase party supplies to create web and database traffic.</p> </li> <li> <p>Within your Remote Desktop, open Command Prompt by clicking Start, typing <code>command prompt</code>, and pressing enter.</p> </li> <li> <p>Type <code>ping -t FIESTA-WEBSERVER-IP-ADDRESS</code> and press Enter to start a continuous ping from your User##-WinTools VM to the IP address of your Fiesta web server.</p> <p>Now let's secure the Fiesta App using Flow Network Security.</p> </li> <li> <p>Within Prism Central, select Sign Out from the username drop-down (in this case Consumer##) located in the upper right corner. Log into Prism Central.</p> </li> <li> <p>Log into Prism Central.</p> <ul> <li>username - <code>adminuser##@ntnxlab.local</code></li> <li>password - <code>nutanix default</code></li> </ul> </li> <li> <p>Navigate to  &gt; Network &amp; Security &gt; Security Policies.</p> </li> <li> <p>Click the Security Policy User##-FiestaApp. This is the policy associated with your Fiesta App deployment.</p> <p>There are two operational states for a security policy: Monitor and Enforce. Your policy is currently in Monitor Mode.</p> </li> <li> <p>Monitor monitors the policy without restricting traffic flows. All traffic flowing through the policy is still logged to the configured Syslog server even though no action is being taken to limit the data flow.</p> </li> <li> <p>Enforce restricts communications based on the configured policy.</p> </li> <li> <p>Within the security policy, the solid blue connections are the traffic permitted by the policy. You can hover over these lines to view what is being allowed.</p> <p></p> <p>Traffic displayed in yellow would automatically be blocked if the policy changed from Monitor to Enforce.</p> </li> <li> <p>Hover over the discovered traffic sourced from your User##-WinTools VM pings. You will see the ICMP traffic you are generating from your WinTools VM.</p> <p></p> <p>Let's change the policy mode to Enforce. </p> </li> <li> <p>Click Enforce from the upper right menu. </p> </li> <li> <p>Type ENFORCE into the confirmation window.</p> <p></p> <p>This secondary confirmation helps customers avoid activating a misconfigured security policy, which could result in application interruptions or a weakened security state.</p> </li> <li> <p>Close your security policy by clicking :fa-x: in the top right corner. Open your policy by selecting your User##-FiestaApp security policy.</p> <p>The traffic previously shown in yellow while the policy was in monitor mode is now blocked and shown in red.</p> <p>Your Fiesta app will still be accessible in the web browser while the ping is blocked.</p> <p></p> </li> <li> <p>Return to your Remote Desktop session, and observe that your ping command is no longer receiving a response.</p> <p></p> </li> </ol>"},{"location":"chapter3/chapter3/#security-policy-logging","title":"Security Policy Logging","text":"<p>Let's go back to our syslog server and see what it detected. While our policy dropped the traffic, we need more than this to satisfy our security auditing team.</p> <ol> <li>Open your browser, enter <code>http://GRAYLOG-IP-ADDRESS:9000</code>, and press the Enter key. Log in with the following credentials:</li> <li>Username - <code>admin</code></li> <li>Password - <code>nutanix default</code></li> <li> <p>Click Streams &gt; All Messages.</p> </li> <li> <p>Within the time range drop-down, select Search in the last 30 minutes. Enter the search term <code>hitcount*</code> and press the Enter key.</p> <p>Find the log entries associated with your application and policy and note the ACTION field in the message.</p> <p>You will see flowing traffic and allowed tagged as ACTION=ALLOW.</p> <p>You will also see the ICMP traffic from your User##-WinTools VM being blocked with ACTION=DROP.</p> </li> </ol> <p></p> <pre><code>We will now amend this policy to allow ICMP between **User##-WinTools** to your **User##-WebServer**.\n</code></pre> <ol> <li> <p>Return to Prism Central, and click Update. To allow the discovered flows in the Security Policy,</p> </li> <li> <p>Click Next &gt; Ok, got it!.</p> </li> <li> <p>Hover over the User##-WinTools entry within the Inbounds &gt; Blocked section.</p> </li> <li> <p>Click Allow Traffic.</p> <p></p> </li> <li> <p>Check the box adjacent to User##-WinTools within the Source column, and click Allow 1 Discovered Traffic in the lower right corner. </p> <p></p> </li> <li> <p>Click Next &gt; Save and Enforce.</p> </li> <li> <p>Click the Security Policy User##-FiestaApp. You will now see the previously-blocked ICMP traffic flowing between User##-WinTools to your User##-WebServer.</p> <p></p> </li> <li> <p>Return to your Remote Desktop session. Observe that your ping is no longer blocked.</p> <p></p> </li> </ol>"},{"location":"chapter3/chapter3/#conclusion","title":"Conclusion","text":"<ul> <li> <p>You've seen how security exists at all layers of the Nutanix Cloud Platform, from infrastructure to applications. Now you're ready to show the CISO how to protect their infrastructure and remediate vulnerabilities.</p> </li> <li> <p>To learn more about security, sign up for the Nutanix Platform Security in Depth session, where we'll cover these features and more.</p> </li> <li> <p>We invite you to share these lab exercises and demos after you return home.</p> </li> <li> <p>Please take the time to fill out the Slido survey. You can scan the QR code on your table sheet to open the URL, or use the Tech Summit app. Thank you so much!</p> </li> </ul>"},{"location":"example/","title":"Getting Started","text":""}]}